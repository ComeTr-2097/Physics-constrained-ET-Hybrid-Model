# About Physics-contrained ET Hybrid Model

The hybrid model consists of two main components: a machine learning module for simulating surface resistance (rs) or aerodynamic resistance (ra), and a physical model (Penman Monteith or Surface Energy Balance model) for predicting LE.

We developed our hybrid models using Python. Similar to machine learning models, the dataset was partitioned into training (70%) and validation (20%) sets to dynamically update the internal model parameters during the fitting process. The test set (10%) was then used to assess the performance of the physics-constrained hybrid models. 

We employed three machine learning (ML) approaches — Artificial Neural Network (ANN), Random Forest (RF), and Light Gradient Boosting Machine (LGBM) — to develop both data-driven and physics-constrained ET models. These ML approaches with different characteristics and complexity, have been widely applied in the carbon and water cycle modeling for terrestrial ecosystems. ANN simulates human neural networks by adjusting synaptic weights through backpropagation, allowing it to learn intricate data patterns. RF, as an ensemble method of decision trees, builds each tree from randomized subsets and averages predictions for enhanced accuracy. LGBM, an optimized gradient boosting method, uses a leaf-wise strategy for tree expansion, supported by efficient sampling techniques, to improve model accuracy and training speed.

After reviewing the required model attributes for regional ET algorithms, we utilized two classical models: the Penman Monteith model and surface energy balance model.The Penman Monteith (PM) model has been successfully applied to the MODIS global ET framework, which eliminates land surface temperature and utilizes remotely sensed vegetation indices to inform the model of the water availability on the land surface. More details are showed in [MOD16](https://github.com/arthur-e/MOD16) The surface energy balance (SEB) model calculates the flux of sensible heat by calculating the aerodynamic resistance (ra). More reference is [here](https://github.com/jvdkwast/PySEBS).

In the Penman Monteith (PM) approach, surface resistance (rs) governs the water vapor and energy exchange between the ground surface and the atmosphere. rs is controlled by the joint effect of meteorological, soil, and vegetation factors. Numerous studies have showed that rs is a primary source of uncertainty in PM-based estimations.In the surface energy balance (SEB) model, aerodynamic resistance (ra) is the most sensitive parameter, as it captures the turbulent exchange between the land surface and the atmosphere. Traditionally, ra has been parameterized as a function of surface roughness, vegetation, and soil variables, with considerable variability across climates and surface types. However, the determination of these atmospheric boundary layer parameters is quite complex and difficult, thus lead to errors in ra estimation.  we employed machine learning models to predict rs and ra, and subsequently incorporated the predicted rs or ra into the PM and SEB method to estimate LE. The resulting model is referred to as the ML_PM or ML_SEB hybrid model.

Here is the structure of the hybrid models, and additional details are provided in the accompanying code.
![Hybrid_ANN](https://github.com/user-attachments/assets/74afcc0f-8458-4e17-8c12-2eba2c9f4e94)
![Hybrid_RF](https://github.com/user-attachments/assets/801a2efd-731b-482e-859d-396014b9f8bc)
![Hybrid_LGBM](https://github.com/user-attachments/assets/159c3ee3-940a-4db9-b1c3-c08645b99d6d)
